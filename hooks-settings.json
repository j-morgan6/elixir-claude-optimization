{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "command",
            "command": "if grep -qE 'def\\s+(mount|handle_event|handle_info|handle_call|handle_cast|render|init|terminate)\\(' \"$CLAUDE_HOOK_FILE_PATH\" 2>/dev/null && ! grep -B1 \"def\\s\\+(mount|handle_event|handle_info|handle_call|handle_cast|render|init|terminate)\\(\" \"$CLAUDE_HOOK_FILE_PATH\" 2>/dev/null | grep -q '@impl'; then echo '‚ö†Ô∏è  Missing @impl true before callback function. Add @impl true before mount, handle_event, handle_info, handle_call, handle_cast, render, init, or terminate callbacks.' && exit 2; fi",
            "description": "Block callbacks without @impl true"
          },
          {
            "type": "command",
            "command": "if grep -qE '(upload_path|file_path|uploads_dir)\\s*=\\s*[\"'\\''](/|priv/)' \"$CLAUDE_HOOK_FILE_PATH\" 2>/dev/null; then echo 'üö´ Hardcoded file path detected. Use Application.get_env(:app, :config_key) instead.' && exit 2; fi",
            "description": "Block hardcoded file paths"
          },
          {
            "type": "command",
            "command": "if grep -qE '(max_file_size|file_size_limit|max_upload)\\s*=\\s*[0-9]{7,}' \"$CLAUDE_HOOK_FILE_PATH\" 2>/dev/null; then echo 'üö´ Hardcoded file size limit detected. Move to Application config.' && exit 2; fi",
            "description": "Block hardcoded file size limits"
          },
          {
            "type": "command",
            "command": "if grep -qE 'if\\s+.+\\s+do\\s+.*if\\s+.+\\s+do' \"$CLAUDE_HOOK_FILE_PATH\" 2>/dev/null; then echo '‚ö†Ô∏è  Nested if/else detected. Consider using pattern matching or case statements for more idiomatic Elixir.' && exit 1; fi",
            "description": "Warn on nested if/else"
          },
          {
            "type": "command",
            "command": "if grep -qE '\\|>\\s*Enum\\.(map|filter)\\([^)]+\\)\\s*\\|>\\s*Enum\\.(map|filter)\\(' \"$CLAUDE_HOOK_FILE_PATH\" 2>/dev/null; then echo '‚ö†Ô∏è  Multiple Enum operations detected. Consider using a for comprehension or Enum.reduce for better performance.' && exit 1; fi",
            "description": "Warn on inefficient Enum chains"
          },
          {
            "type": "command",
            "command": "if grep -qE 'Enum\\.(map|reduce|each).*<>' \"$CLAUDE_HOOK_FILE_PATH\" 2>/dev/null; then echo '‚ö†Ô∏è  String concatenation with <> in Enum operations. Consider using IO lists or Enum.join for better performance.' && exit 1; fi",
            "description": "Warn on string concatenation in loops"
          }
        ]
      }
    ]
  }
}
